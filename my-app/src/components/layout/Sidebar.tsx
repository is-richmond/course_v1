"use client";

import React, { useState, useEffect } from "react";
import Link from "next/link";
import { usePathname, useRouter } from "next/navigation";
import { useAuth } from "@/src/contexts/AuthContext";

interface NavItem {
  label: string;
  href?: string;
  icon?:  React.ReactNode;
  children?: NavItem[];
  className?: string;
}

interface SidebarProps {
  isOpen?:  boolean;
  onClose?: () => void;
}

export const Sidebar: React.FC<SidebarProps> = ({ isOpen, onClose }) => {
  const pathname = usePathname();
  const router = useRouter();
  const { user, logout, isLoading } = useAuth();
  const [expandedItems, setExpandedItems] = useState<string[]>([]);
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    setMounted(true);
  }, []);

  // Close sidebar on route change (mobile)
  useEffect(() => {
    if (onClose) {
      onClose();
    }
  }, [pathname]);

  const toggleExpand = (label: string) => {
    setExpandedItems((prev) =>
      prev.includes(label)
        ? prev.filter((item) => item !== label)
        : [...prev, label]
    );
  };

  // Navigation items for authenticated users
  const authNavItems:  NavItem[] = [
    {
      label: "Мои курсы",
      href: "/",
      icon: (
        <svg width="30" height="26" viewBox="0 0 30 26" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 25.9278V16.7768H18V25.9278H25.5V13.7265H30L15 0L0 13.7265H4.5V25.9278H12Z" fill="white"/>
        </svg>

      ),
    },
    {
      label: "Тесты",
      href: "/tests",
      icon: (
        <svg width="29" height="29" viewBox="0 0 29 29" fill="none" xmlns="http://www.w3.org/2000/svg">
          <mask id="mask0_1137_287" style={{ maskType: 'luminance' }} maskUnits="userSpaceOnUse" x="1" y="1" width="27" height="27">
            <path d="M14.5003 26.5834C16.0874 26.5853 17.6593 26.2737 19.1255 25.6663C20.5918 25.0589 21.9236 24.1678 23.0445 23.0442C24.1681 21.9233 25.0592 20.5915 25.6666 19.1252C26.274 17.659 26.5856 16.0871 26.5837 14.5C26.5856 12.9129 26.274 11.3411 25.6666 9.87483C25.0592 8.40855 24.1681 7.07674 23.0445 5.9559C21.9236 4.83225 20.5918 3.94114 19.1255 3.33377C17.6593 2.7264 16.0874 2.41474 14.5003 2.4167C12.9132 2.41474 11.3414 2.7264 9.87513 3.33377C8.40886 3.94114 7.07704 4.83225 5.95621 5.9559C4.83256 7.07674 3.94145 8.40855 3.33408 9.87483C2.7267 11.3411 2.41504 12.9129 2.417 14.5C2.41504 16.0871 2.7267 17.659 3.33408 19.1252C3.94145 20.5915 4.83256 21.9233 5.95621 23.0442C7.07704 24.1678 8.40886 25.0589 9.87513 25.6663C11.3414 26.2737 12.9132 26.5853 14.5003 26.5834Z" fill="white" stroke="white" strokeWidth="2" strokeLinejoin="round"/>
            <path d="M9.66699 14.5L13.292 18.125L20.542 10.875" stroke="black" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
          </mask>
          <g mask="url(#mask0_1137_287)">
            <path d="M0 0H29V29H0V0Z" fill="white"/>
          </g>
        </svg>

      ),
    },
    {
      label: "Дашборды тестов",
      icon: (
        <svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M23.5121 1.03088L16.027 3.84163L18.7133 5.53518C13.9145 11.5781 6.97266 15.3004 1.10742 16.7172L2.76898 19.7438C9.35938 17.5957 16.3367 13.7211 20.8309 6.87581L22.8773 8.16565L23.5121 1.03088ZM23.9031 6.95706L23.6594 9.73987L21.0543 8.09456C20.9629 8.23166 20.8664 8.3637 20.7699 8.50081V24.7305H24.7309V6.95706H23.9031ZM16.2555 13.4571C15.6105 14.0156 14.9453 14.5438 14.2699 15.0414V24.7305H18.2309V13.4571H16.2555ZM9.97383 17.7227C9.24258 18.1086 8.51133 18.4641 7.76992 18.7992V24.7305H11.7309V17.7227H9.97383ZM1.26992 19.9571V24.7305H5.23086V19.9571H4.94242C4.18984 20.2364 3.43777 20.4953 2.69027 20.734L2.33176 20.8457L1.84426 19.9571H1.26992Z" fill="white"/>
        </svg>

      ),
      children: [
        { label: "Комбо-тесты", href: "/dashboard", className: "text-sm"},
        { label: "Обычные тесты", href: "/test_dashboard", className: "text-sm" },
      ],
    },
    {
      label: "Профиль",
      icon: (
        <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M11.25 17.2021C9.8 17.2021 8.5625 16.691 7.5375 15.6689C6.5125 14.6467 6 13.4126 6 11.9667C6 10.5207 6.5125 9.28663 7.5375 8.26448C8.5625 7.24233 9.8 6.73125 11.25 6.73125C12.7 6.73125 13.9375 7.24233 14.9625 8.26448C15.9875 9.28663 16.5 10.5207 16.5 11.9667C16.5 13.4126 15.9875 14.6467 14.9625 15.6689C13.9375 16.691 12.7 17.2021 11.25 17.2021ZM11.25 14.2104C11.875 14.2104 12.406 13.992 12.843 13.5552C13.281 13.1195 13.5 12.5899 13.5 11.9667C13.5 11.3434 13.281 10.8139 12.843 10.3781C12.406 9.94131 11.875 9.72292 11.25 9.72292C10.625 9.72292 10.094 9.94131 9.657 10.3781C9.219 10.8139 9 11.3434 9 11.9667C9 12.5899 9.219 13.1195 9.657 13.5552C10.094 13.992 10.625 14.2104 11.25 14.2104ZM21.75 18.6979C20.7 18.6979 19.8125 18.3364 19.0875 17.6134C18.3625 16.8904 18 16.0054 18 14.9583C18 13.9112 18.3625 13.0262 19.0875 12.3032C19.8125 11.5802 20.7 11.2188 21.75 11.2188C22.8 11.2188 23.6875 11.5802 24.4125 12.3032C25.1375 13.0262 25.5 13.9112 25.5 14.9583C25.5 16.0054 25.1375 16.8904 24.4125 17.6134C23.6875 18.3364 22.8 18.6979 21.75 18.6979ZM12.45 26.6258C13.575 24.3572 15.075 22.8424 16.95 22.0815C18.825 21.3216 20.425 20.9417 21.75 20.9417C22.325 20.9417 22.8875 20.9915 23.4375 21.0912C23.9875 21.191 24.525 21.3156 25.05 21.4652C25.65 20.5178 26.125 19.4957 26.475 18.3988C26.825 17.3018 27 16.155 27 14.9583C27 11.6176 25.8375 8.78802 23.5125 6.46948C21.1875 4.15094 18.35 2.99167 15 2.99167C11.65 2.99167 8.8125 4.15094 6.4875 6.46948C4.1625 8.78802 3 11.6176 3 14.9583C3 16.0802 3.1435 17.1522 3.4305 18.1744C3.7185 19.1965 4.15 20.1439 4.725 21.0165C5.7 20.5178 6.7315 20.1314 7.8195 19.8572C8.9065 19.583 10.05 19.4458 11.25 19.4458C12.05 19.4458 12.819 19.5141 13.557 19.6508C14.294 19.7884 15.025 19.9694 15.75 20.1937C15.175 20.4929 14.6315 20.8419 14.1195 21.2408C13.6065 21.6397 13.125 22.0635 12.675 22.5123C12.375 22.4624 12.119 22.4375 11.907 22.4375H11.25C10.425 22.4375 9.625 22.5248 8.85 22.6993C8.075 22.8738 7.325 23.1356 6.6 23.4846C7.4 24.2824 8.294 24.9495 9.282 25.486C10.269 26.0215 11.325 26.4015 12.45 26.6258ZM15 29.9167C12.925 29.9167 10.975 29.5238 9.15 28.7379C7.325 27.9531 5.7375 26.8876 4.3875 25.5414C3.0375 24.1951 1.969 22.612 1.182 20.7921C0.394 18.9722 0 17.0276 0 14.9583C0 12.8891 0.394 10.9445 1.182 9.12458C1.969 7.30465 3.0375 5.72156 4.3875 4.37531C5.7375 3.02906 7.325 1.96303 9.15 1.17722C10.975 0.392407 12.925 0 15 0C17.075 0 19.025 0.392407 20.85 1.17722C22.675 1.96303 24.2625 3.02906 25.6125 4.37531C26.9625 5.72156 28.031 7.30465 28.818 9.12458C29.606 10.9445 30 12.8891 30 14.9583C30 17.0276 29.606 18.9722 28.818 20.7921C28.031 22.612 26.9625 24.1951 25.6125 25.5414C24.2625 26.8876 22.675 27.9531 20.85 28.7379C19.025 29.5238 17.075 29.9167 15 29.9167Z" fill="white"/>
        </svg>

      ),
      children: [
        { label:  "Мой профиль", href: "/profile" },
        { label: "Смена пароля", href: "/auth/change-password" },
      ],
    },
    {
      label: "Помощь",
      icon: (
        <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.5 23.9333H16.5V20.9417H13.5V23.9333ZM15 0C6.72 0 0 6.70133 0 14.9583C0 23.2153 6.72 29.9167 15 29.9167C23.28 29.9167 30 23.2153 30 14.9583C30 6.70133 23.28 0 15 0ZM15 26.925C8.385 26.925 3 21.555 3 14.9583C3 8.36171 8.385 2.99167 15 2.99167C21.615 2.99167 27 8.36171 27 14.9583C27 21.555 21.615 26.925 15 26.925ZM15 5.98333C11.685 5.98333 9 8.66087 9 11.9667H12C12 10.3212 13.35 8.975 15 8.975C16.65 8.975 18 10.3212 18 11.9667C18 14.9583 13.5 14.5844 13.5 19.4458H16.5C16.5 16.0802 21 15.7062 21 11.9667C21 8.66087 18.315 5.98333 15 5.98333Z" fill="white"/>
        </svg>

      ),
      children: [
        { label: "FAQ", href: "/faq" },
      ],
    },
  ];

  // Navigation items for non-authenticated users
  const guestNavItems: NavItem[] = [
    {
      label:  "Главная",
      href: "/",
      icon: (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="15"
          height="15"
          viewBox="0 0 256 256"
        >
          <path
            fill="currentColor"
            d="M224,115.55V208a16,16,0,0,1-16,16H168a16,16,0,0,1-16-16V168a8,8,0,0,0-8-8H112a8,8,0,0,0-8,8v40a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V115.55a16,16,0,0,1,5.17-11.78l80-75.48a16,16,0,0,1,21.66,0l80,75.48A16,16,0,0,1,224,115.55Z"
          />
        </svg>
      ),
    },
    {
      label: "О платформе",
      href: "/about",
      icon: (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="15"
          height="15"
          viewBox="0 0 256 256"
        >
          <path
            fill="currentColor"
            d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm-8-80V80a8,8,0,0,1,16,0v56a8,8,0,0,1-16,0Zm20,36a12,12,0,1,1-12-12A12,12,0,0,1,140,172Z"
          />
        </svg>
      ),
    },
    {
      label: "FAQ",
      href: "/faq",
      icon: (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="15"
          height="15"
          viewBox="0 0 256 256"
        >
          <path
            fill="currentColor"
            d="M140,180a12,12,0,1,1-12-12A12,12,0,0,1,140,180ZM128,72c-22.06,0-40,16.15-40,36v4a8,8,0,0,0,16,0v-4c0-11,10.77-20,24-20s24,9,24,20-10.77,20-24,20a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-. 72c18.24-3.35,32-17.9,32-35.28C168,88.15,150.06,72,128,72Zm104,56A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"
          />
        </svg>
      ),
    },
  ];

  const navItems = mounted && user ? authNavItems : guestNavItems;

  const isActive = (href?:  string) => href && pathname === href;

  const handleLogout = () => {
    logout();
    router.push("/auth/login");
  };

  // Determine if this is being rendered as mobile drawer
  const isMobileMode = typeof isOpen !== "undefined";

  return (
    <>
      {/* Overlay for mobile */}
      {isMobileMode && isOpen && (
        <div
          className="fixed inset-0 bg-black/60 backdrop-blur-sm z-40 lg:hidden transition-opacity duration-300"
          onClick={onClose}
          aria-hidden="true"
        />
      )}

      <aside
        className={`
          fixed left-0 top-0 h-screen w-72 bg-blue-900
          text-white shadow-2xl z-50 overflow-y-auto
          transition-all duration-300 ease-out
          ${
            isMobileMode
              ?  isOpen
                ? "translate-x-0 opacity-100"
                : "-translate-x-full opacity-0"
              : "hidden lg:block lg:w-64"
          }
        `}
      >
        {/* Close button for mobile - positioned in header area */}
        {isMobileMode && (
          <button
            onClick={onClose}
            className="absolute top-4 right-4 p-2 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition-all duration-200 lg:hidden z-10"
            aria-label="Закрыть меню"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 256 256"
            >
              <path
                fill="currentColor"
                d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"
              />
            </svg>
          </button>
        )}

        {/* Logo - sticky header */}
        <div className="sticky top-0 bg-blue-900 backdrop-blur-md px-4 py-4 border-b border-white/10">
          <Link href="/" className="flex items-center gap-3" onClick={onClose}>
            <img
              src="/logo1.png"
              alt="Plexus"
              className="w-10 h-10"
            />
            <span className="font-bold text-lg tracking-tight">Plexus</span>
          </Link>
        </div>

        {/* Navigation */}
        <nav className="px-3 py-5 space-y-1">
          {navItems.map((item) => (
            <div key={item.label}>
              {item.href ? (
                <Link
                  href={item.href}
                  onClick={onClose}
                  className={`flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 ${
                    isActive(item. href)
                      ? "bg-blue-600 text-white shadow-lg"
                      : "text-blue-100 hover:bg-blue-700/60"
                  }`}
                >
                  {item.icon}
                  <span className="text-sm">{item.label}</span>
                </Link>
              ) : (
                <>
                  <button
                    onClick={() => toggleExpand(item.label)}
                    className="w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 text-blue-100 hover:bg-blue-700/60 hover:text-white"
                  >
                    {item. icon}
                    <span className="text-sm flex-1 text-left">
                      {item.label}
                    </span>
                    {item.children && (
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="10"
                        height="10"
                        viewBox="0 0 256 256"
                        className={`transition-transform duration-300 ${
                          expandedItems.includes(item.label) ? "rotate-180" : ""
                        }`}
                      >
                        <path
                          fill="currentColor"
                          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"
                        />
                      </svg>
                    )}
                  </button>

                  {/* Submenu */}
                  {item.children && expandedItems.includes(item.label) && (
                    <div className="ml-4 mt-1 space-y-1 border-l-2 border-blue-500">
                      {item.children. map((child) => (
                        <Link
                          key={child.label}
                          href={child.href || "#"}
                          onClick={onClose}
                          className={`flex items-center gap-2 px-4 py-2.5 rounded-lg transition-all duration-200 font-medium ${child.className ?? "text-xs"} ${

                            isActive(child.href)
                              ? "bg-blue-600 text-white shadow-md translate-x-1"
                              : "text-blue-200 hover:text-white hover:bg-blue-700/50"
                          }`}
                        >
                          <span>{child.label}</span>
                        </Link>
                      ))}
                    </div>
                  )}
                </>
              )}
            </div>
          ))}
        </nav>

        {/* Bottom Section */}
        <div className="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-blue-950 to-blue-900 border-t border-blue-700 px-3 py-4 space-y-1">
          {mounted && user ? (
            <>
              <Link href="/profile" onClick={onClose}>
                <button className="w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 text-blue-100 hover:bg-blue-700 hover:text-white">
                  <svg width="38" height="38" viewBox="0 0 38 38" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fillRule="evenodd" clipRule="evenodd" d="M22.1417 4.02483C22.2794 4.29242 22.3142 4.636 22.3823 5.32317C22.5122 6.6215 22.5771 7.27067 22.8494 7.6285C23.0191 7.85068 23.2446 8.02397 23.5029 8.13076C23.7613 8.23755 24.0433 8.27403 24.3203 8.2365C24.7637 8.17792 25.2703 7.76467 26.2805 6.93817C26.8141 6.49958 27.0817 6.28108 27.3682 6.18925C27.7332 6.07262 28.1282 6.09231 28.4797 6.24467C28.7568 6.365 29.0022 6.60883 29.4883 7.0965L30.9038 8.512C31.3915 8.99967 31.6353 9.2435 31.7557 9.52058C31.908 9.87217 31.9277 10.2671 31.8111 10.6321C31.7192 10.9187 31.5007 11.1863 31.0637 11.7198C30.2357 12.7316 29.8224 13.2367 29.7622 13.6816C29.7252 13.9585 29.762 14.2403 29.8691 14.4984C29.9762 14.7564 30.1496 14.9816 30.3718 15.1509C30.7281 15.4233 31.3788 15.4882 32.6787 15.618C33.3643 15.6861 33.7079 15.7209 33.9771 15.8587C34.3166 16.0347 34.581 16.3278 34.7212 16.6836C34.8337 16.9638 34.8337 17.309 34.8337 17.9993V20.0007C34.8337 20.691 34.8337 21.0362 34.7228 21.3148C34.5821 21.6718 34.3165 21.9655 33.9755 22.1413C33.7079 22.2791 33.3643 22.3139 32.6772 22.382C31.3788 22.5118 30.7297 22.5768 30.3718 22.8491C30.1496 23.0188 29.9764 23.2442 29.8696 23.5026C29.7628 23.761 29.7263 24.043 29.7638 24.32C29.824 24.7633 30.2372 25.27 31.0637 26.2802C31.5007 26.8138 31.7192 27.0798 31.8111 27.3679C31.9277 27.7329 31.908 28.1278 31.7557 28.4794C31.6353 28.7565 31.3915 29.0003 30.9038 29.488L29.4883 30.9019C29.0007 31.3912 28.7568 31.635 28.4797 31.7538C28.1282 31.9061 27.7332 31.9258 27.3682 31.8092C27.0817 31.7173 26.8141 31.4988 26.2805 31.0618C25.2687 30.2353 24.7637 29.8221 24.3203 29.7635C24.0433 29.726 23.7613 29.7625 23.5029 29.8692C23.2446 29.976 23.0191 30.1493 22.8494 30.3715C22.5771 30.7278 22.5122 31.3769 22.3823 32.6768C22.3142 33.364 22.2794 33.7076 22.1417 33.9752C21.9662 34.3159 21.6731 34.5814 21.3167 34.7225C21.0365 34.8333 20.6913 34.8333 20.001 34.8333H17.9997C17.3093 34.8333 16.9642 34.8333 16.6855 34.7225C16.3285 34.5818 16.0348 34.3162 15.859 33.9752C15.7212 33.7076 15.6864 33.364 15.6183 32.6768C15.4885 31.3785 15.4236 30.7293 15.1512 30.3715C14.9817 30.1496 14.7565 29.9764 14.4984 29.8697C14.2404 29.7629 13.9587 29.7263 13.6819 29.7635C13.237 29.8221 12.7319 30.2353 11.7202 31.0618C11.1866 31.5004 10.919 31.7189 10.6324 31.8108C10.2674 31.9274 9.8725 31.9077 9.52091 31.7553C9.24383 31.635 8.99841 31.3912 8.51233 30.9035L7.09683 29.488C6.60916 29.0003 6.36533 28.7565 6.24499 28.4794C6.09263 28.1278 6.07294 27.7329 6.18958 27.3679C6.28141 27.0813 6.49991 26.8138 6.93691 26.2802C7.76499 25.2684 8.17824 24.7633 8.23683 24.3184C8.27407 24.0416 8.23744 23.7599 8.13066 23.5019C8.02388 23.2438 7.85075 23.0186 7.62883 22.8491C7.27258 22.5768 6.62183 22.5118 5.32191 22.382C4.63633 22.3139 4.29274 22.2791 4.02358 22.1413C3.68403 21.9653 3.41969 21.6722 3.27941 21.3164C3.16699 21.0362 3.16699 20.691 3.16699 20.0007V17.9993C3.16699 17.309 3.16699 16.9638 3.27783 16.6852C3.41856 16.3282 3.68413 16.0345 4.02516 15.8587C4.29274 15.7209 4.63633 15.6861 5.32349 15.618C6.62183 15.4882 7.27258 15.4233 7.62883 15.1509C7.85104 14.9816 8.02448 14.7564 8.13154 14.4984C8.2386 14.2403 8.27547 13.9585 8.23841 13.6816C8.17824 13.2367 7.76341 12.7316 6.93691 11.7183C6.49991 11.1847 6.28141 10.9187 6.18958 10.6305C6.07294 10.2655 6.09263 9.87059 6.24499 9.519C6.36533 9.2435 6.60916 8.99808 7.09683 8.51042L8.51233 7.0965C8.99999 6.60883 9.24383 6.36342 9.52091 6.24467C9.8725 6.09231 10.2674 6.07262 10.6324 6.18925C10.919 6.28108 11.1866 6.49958 11.7202 6.93658C12.7319 7.76308 13.237 8.17633 13.6803 8.2365C13.9577 8.27415 14.2402 8.23757 14.4989 8.13048C14.7575 8.02339 14.9832 7.84964 15.1528 7.62692C15.422 7.27067 15.4885 6.6215 15.6183 5.32158C15.6864 4.636 15.7212 4.29242 15.859 4.02325C16.0348 3.68311 16.3278 3.41817 16.6839 3.2775C16.9642 3.16667 17.3093 3.16667 17.9997 3.16667H20.001C20.6913 3.16667 21.0365 3.16667 21.3152 3.2775C21.6721 3.41824 21.9658 3.68381 22.1417 4.02483ZM19.0003 25.3333C20.68 25.3333 22.2909 24.6661 23.4787 23.4783C24.6664 22.2906 25.3337 20.6797 25.3337 19C25.3337 17.3203 24.6664 15.7094 23.4787 14.5217C22.2909 13.3339 20.68 12.6667 19.0003 12.6667C17.3206 12.6667 15.7097 13.3339 14.522 14.5217C13.3343 15.7094 12.667 17.3203 12.667 19C12.667 20.6797 13.3343 22.2906 14.522 23.4783C15.7097 24.6661 17.3206 25.3333 19.0003 25.3333Z" fill="white"/>
                  </svg>
                  <span className="font-semibold">Настройки</span>
                </button>
              </Link>
              <button
                onClick={handleLogout}
                className="w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 text-blue-100 hover:bg-red-700 hover:text-white"
              >
                <svg width="31" height="36" viewBox="0 0 31 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path fillRule="evenodd" clipRule="evenodd" d="M23.9148 1.71291e-07C24.7768 -0.000272615 25.607 0.325278 26.239 0.911391C26.8711 1.4975 27.2582 2.30086 27.3229 3.16042L27.3314 3.41667V27.3333H29.0398C29.4752 27.3338 29.894 27.5005 30.2106 27.7994C30.5272 28.0984 30.7178 28.5069 30.7433 28.9415C30.7688 29.3762 30.6274 29.8042 30.3479 30.1381C30.0684 30.472 29.672 30.6866 29.2396 30.738L29.0398 30.75H1.70644C1.27102 30.7495 0.852219 30.5828 0.535603 30.2839C0.218987 29.985 0.028456 29.5765 0.00293839 29.1418C-0.0225792 28.7071 0.118843 28.2791 0.39831 27.9452C0.677777 27.6113 1.07419 27.3967 1.50657 27.3453L1.70644 27.3333H3.41477V3.41667C3.4145 2.55468 3.74005 1.72445 4.32616 1.0924C4.91228 0.460346 5.71563 0.0731908 6.57519 0.00854203L6.83144 1.71291e-07H23.9148ZM19.6439 13.6667C19.3074 13.6667 18.9742 13.7329 18.6633 13.8617C18.3524 13.9905 18.0699 14.1793 17.832 14.4172C17.594 14.6552 17.4053 14.9376 17.2765 15.2485C17.1477 15.5594 17.0814 15.8927 17.0814 16.2292C17.0814 16.5657 17.1477 16.8989 17.2765 17.2098C17.4053 17.5207 17.594 17.8032 17.832 18.0411C18.0699 18.2791 18.3524 18.4678 18.6633 18.5966C18.9742 18.7254 19.3074 18.7917 19.6439 18.7917C20.3236 18.7917 20.9753 18.5217 21.4559 18.0411C21.9365 17.5606 22.2064 16.9088 22.2064 16.2292C22.2064 15.5496 21.9365 14.8978 21.4559 14.4172C20.9753 13.9366 20.3236 13.6667 19.6439 13.6667Z" fill="white"/>
                </svg>

                <span className="font-semibold">Выход</span>
              </button>
            </>
          ) : mounted ?  (
            <>
              <Link href="/auth/login" className="w-full" onClick={onClose}>
                <button className="w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 text-white bg-blue-600 hover: bg-blue-700">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="20"
                    height="20"
                    viewBox="0 0 256 256"
                  >
                    <path
                      fill="currentColor"
                      d="M141.66,133.66l-40,40a8,8,0,0,1-11.32-11.32L116.69,136H24a8,8,0,0,1,0-16h92.69L90.34,93.66a8,8,0,0,1,11.32-11.32l40,40A8,8,0,0,1,141.66,133.66ZM192,32H136a8,8,0,0,0,0,16h56V208H136a8,8,0,0,0,0,16h56a16,16,0,0,0,16-16V48A16,16,0,0,0,192,32Z"
                    />
                  </svg>
                  <span className="font-semibold">Войти</span>
                </button>
              </Link>
              <Link href="/auth/register" className="w-full" onClick={onClose}>
                <button className="w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 text-blue-100 hover:bg-blue-700 hover:text-white">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="20"
                    height="20"
                    viewBox="0 0 256 256"
                  >
                    <path
                      fill="currentColor"
                      d="M256,136a8,8,0,0,1-8,8H232v16a8,8,0,0,1-16,0V144H200a8,8,0,0,1,0-16h16V112a8,8,0,0,1,16,0v16h16A8,8,0,0,1,256,136Zm-57.87,58.85a8,8,0,0,1-12.26,10.3C165.75,181.19,138.09,168,108,168s-57.75,13.19-77.87,37.15a8,8,0,0,1-12.25-10.3c14.94-17.78,33.52-30.41,54.17-37.17a68,68,0,1,1,71.9,0C164.6,164.44,183.18,177.07,198.13,194.85ZM108,152a52,52,0,1,0-52-52A52.06,52.06,0,0,0,108,152Z"
                    />
                  </svg>
                  <span className="font-semibold">Регистрация</span>
                </button>
              </Link>
            </>
          ) : null}
        </div>
      </aside>
    </>
  );
};